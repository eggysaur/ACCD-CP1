<!doctype html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>p5 full-width canvas</title>
    <style>
        @import url('style.css');
        
    </style>
</head>
<body>

<div id="container"></div>

<div id="controls" style="padding:8px 12px; font-family: sans-serif;">
    <label for="speedSlider">Speed:</label>
    <input id="speedSlider" type="range" min="0" max="0.1" step="0.001" value="0.03" />
    <span id="speedValue">0.03</span>
</div>
<div class="blog">
    <h1>Pattern, rhythm, movement</h1>
    <p>Somehow, despite having used p5js many times before, it never occured to me that i <i>could</i> use the HSB mode. This honestly saves a lot of stress.</p>
    <p>I incli
    uded an adjustable speed scrollbar, so you can see how the colors become unsaturated black/white when the ball hits the floor. I struggled to balance the visbility of this effect while retaining the interesting visual motion, so i just made it up to the user to choose. It kind of resembles the motion of a piano imo.</p>
   
    <p>The biggest issue in the project is trying to process the math in my head, for everything. If you haven't noticed, when you resize the column you're able to shrink the width of all the rectangles and positions of the circles. This was kind of hard to do in my head, and to be honest, the way i did it looks wrong, but it works so whatever.</p>
     <p>To be honest, to figure out the ease-in/ease-out i used some math that i don't really remember how it worked. i just took some equation and variables i did in previous projects and just reapplied it. Overall everything is just solved using not too complicated math.</p>
</div>

<script src="https://cdn.jsdelivr.net/npm/p5@1.6.0/lib/p5.min.js"></script>
<script>
    let cnv;
    let t = 0;
    let speed = 0.03;
    let amplitude;
    let baseY;
    let w = 10;
    let recw;
    let count = 20;  // how many columns

    function setup() {
    cnv = createCanvas(document.documentElement.clientWidth, windowHeight);
    cnv.parent("container");
    colorMode(HSB, 100, 100, 100);

        // initialize DOM controls
        const slider = document.getElementById('speedSlider');
        const speedDisplay = document.getElementById('speedValue');
        // set starting value from JS variable
        slider.value = speed;
        speedDisplay.textContent = Number(speed).toFixed(3);
        // update speed when the slider moves
        slider.addEventListener('input', () => {
            speed = parseFloat(slider.value);
            speedDisplay.textContent = Number(speed).toFixed(3);
        });

        calculateLayout();
    }

    function draw() {
    background(20);
    t += speed;
    noStroke();

    for (let i = 0; i < count; i++) {
        let offset = i * 0.13;
        let bounce = abs(sin(t + offset));
        let y = baseY - bounce * amplitude;

        let sat = ((baseY - y) / amplitude) * 100;

        fill(i * 3, sat, 100);
        rect(i * recw, 0, recw, height);

        fill(25 + i * 3, 100, sat);
        ellipse(i * recw + recw / 2, y, w * 2);
    }
    }

    function windowResized() {
    resizeCanvas(document.documentElement.clientWidth, windowHeight);
    calculateLayout();
    }

    function calculateLayout() {
    recw = width / count;
    baseY = height - w;
    amplitude = height * 0.75;
    }

</script>

</body>
</html>
